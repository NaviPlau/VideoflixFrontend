<div class="video-container" (mousemove)="showControls()">
  
  <!-- Pre-Play Overlay -->
  @if (showOverlay) {
    <div class="video-overlay">
      <h2>{{ currentVideoData?.title }}</h2>
      <p>{{ currentVideoData?.description }}</p>

      <div class="overlay-buttons">
        <button (click)="startVideo()">
          @if (currentVideoData?.user_progress?.last_viewed_position != 0 &&currentVideoData?.user_progress != null || !videoEnded) {
            â–¶ Continue Watching
          } @else if (currentVideoData?.user_progress?.viewed || videoEnded) {
            ğŸ”„ Replay
          } @else if(currentVideoData?.user_progress === null || currentVideoData?.user_progress?.last_viewed_position === 0 || !videoEnded) {
            â–¶ Play
          }
        </button>
        <button (click)="closeVideo()">âŒ Close</button>
      </div>
    </div>
  }

  <!-- Video Player -->
  <video #videoPlayerFull width="640" height="360" 
         (click)="togglePlay()" 
         (timeupdate)="updateProgress()"></video>

  <!-- Close Button -->
  <div class="close-button" (click)="closeVideo()">
    <mat-icon>close</mat-icon>
  </div>

  <!-- Custom Controls -->
  <div class="custom-controls" [class.visible]="controlsVisible">
    <button (click)="togglePlay()">
      <span *ngIf="!isPlaying">â–¶ï¸</span>
      <span *ngIf="isPlaying">â¸ï¸</span>
    </button>
    
    <div class="volume-control">
      <button (click)="toggleMute()">
        <span *ngIf="!isMuted && currentVolume > 0.5">ğŸ”Š</span>
        <span *ngIf="!isMuted && currentVolume > 0 && currentVolume <= 0.5">ğŸ”‰</span>
        <span *ngIf="isMuted || currentVolume === 0">ğŸ”‡</span>
      </button>
      <input type="range" min="0" max="1" step="0.01" [(ngModel)]="currentVolume" (input)="changeVolume($event)" class="volume-slider"/>
    </div>
    
    <div class="progress-bar" (click)="seek($event)">
      <div class="progress" [style.width.%]="progress"></div>
    </div>

    <select (change)="changeQuality($event)" class="quality-selector">
      <option [value]="-1" [selected]="currentQuality === -1">Auto</option>
      <option *ngFor="let quality of availableQualities" [value]="quality.level">
        {{ quality.label }}
      </option>
    </select>
    
    <button (click)="toggleFullscreen()">ğŸ”³</button>
  </div>

</div>








